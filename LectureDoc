import java.io.BufferedReader;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.HashMap;

public class LectureDoc {

    public HashMap<String, Boulevard> ouvrirFichier() {
        try {
            BufferedReader br1 = new BufferedReader(new InputStreamReader(new FileInputStream("src/reseauBoulevard.txt")));

            HashMap<String, Boulevard> reseau = new HashMap<>();
            String ligne;

            while ((ligne = br1.readLine()) != null) {
                if (ligne.isBlank()) continue;

                String intersection = ligne.split(";")[0];
                Boulevard Bv = new Boulevard();
                Bv.nom = intersection;
                reseau.put(intersection, Bv );
            }

            br1.close();

            BufferedReader br2 = new BufferedReader(new InputStreamReader(new FileInputStream("src/reseauBoulevard.txt")));

            while ((ligne = br2.readLine()) != null) {
                if (ligne.isBlank()) continue;

                traiterLigne(ligne, reseau);
            }

            br2.close();
            return reseau;

        } catch (IOException e) {
            System.out.println("Erreur de lecture : " + e.getMessage());
            return null;
        }
    }


    private void traiterLigne(String ligne, HashMap<String, Boulevard> map) {

        String[] t = ligne.split(";");
        String nomIntersection = t[0];

        Boulevard b = map.get(nomIntersection);

        for (int i = 1; i + 3 < t.length; i += 4) {

            String nomRue = t[i];
            int temps = Integer.parseInt(t[i + 1]);
            int tonne = Integer.parseInt(t[i + 2]);
            String intersectionSuivante = t[i + 3];

            Arc a = new Arc();
            a.nom = nomRue;
            a.temps = temps;
            a.tonne = tonne;

            a.Boulevardprec = b;
            a.Boulevardsuiv = map.get(intersectionSuivante);

            b.arc.add(a);
        }
    }
}
